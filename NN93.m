function [Y,Xf,Af] = NN93(X,~,~)
%NN93 neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 06-Apr-2020 22:15:55.
% 
% [Y] = NN93(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1;-1;-1.41109603282199;-3.21602406391519;-1.11837104813401;-1.25909090909091;-1.18533333333333;-1;-1;-1.03894681266355;-1];
x1_step1.gain = [1.69725025739105;0.966897056972233;0.542579461357345;0.350055078626234;0.188449340511196;0.31700288184438;1.09970674486804;0.661873739741648;1.00135399714686;0.508428979474197;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.9528140908908529;-1.8972322227724399;-1.5017916275697245;-0.88978187891380145;-0.96709556454757595;-0.20250972906462694;-1.6611962889095;-0.076950360628422476;-0.61405679559919424;0.09419015655693419;-0.57011473677247682;0.2490368929980136;-0.30936597674294014;0.034348065290101489;0.63266639218209619;0.50368659397656312;-0.52039596890820039;-1.232413184427033;1.7775755599862588;-1.8577386829377069;2.0750473338137501;-2.0412663193307452];
IW1_1 = [0.4986829462662577 -0.25578786125040215 0.052560702278452255 0.21049600073887872 0.93045355153861686 0.50255458017841592 -0.10165546618587852 0.91622559604795495 0.060737864477232041 -0.5370772802502406 0.33076772014592026;0.45789657931505279 -0.17850486717167754 0.42411863402632677 0.20516712364255771 0.74584510674937898 0.22107263478042832 0.71825891417122989 0.71124203082865267 0.35190604392275687 0.8410897001118175 0.72399840252171477;0.061370889397347021 -0.64129849575753528 0.40964170077917694 -0.46954856293770186 0.67392045470397188 0.71615815894548263 0.40209995067083559 -0.39860868931037563 -0.45802280677889123 0.92810503441591374 -0.088368395300783428;0.94904543465392488 -2.371954973714459 -0.81826121905161642 -0.9014628706134451 -0.43781859068472351 0.60503771581470611 1.3208951163882177 -0.030301122784165756 -0.86872141142235393 0.8277130737571895 -0.75397366038664659;1.4677215211054802 -0.027546894178408034 0.54424034456527337 0.024089231709305745 -0.93023717223176372 0.41658645480058443 -1.567340052636901 -0.70822571825884229 0.73035113198791002 0.32454646910199225 -0.90671660531075893;1.8998081521223495 -0.33715424569931679 0.052794338564012548 0.84412688492724541 -0.9070794163940672 -0.32390626631992492 -1.8033594382308897 1.3331625680582471 0.40844459650120024 0.30281496225681348 0.24768925938632388;0.33918352410902802 -1.0559546726197564 -0.63254693750944513 0.076268912645742731 1.5796141904670153 0.27369129813243936 0.12812915656654836 -0.55597868804245432 1.1312059804406758 0.25110286351469674 -1.2994062453758266;1.2600531478389285 -0.81813705590238806 -1.6668023408047525 -0.51993160230582358 -0.57120541185322693 -1.1065821426251667 0.39577867574545111 0.59650871345915957 0.06485218439245187 0.148708771699369 -1.1299123855930808;-2.0305304968158242 -0.23178572011911489 1.2031385641751544 -2.5825500192878499 -0.6730046463011653 -1.1748573351858711 0.96308464116501469 -0.60545563917552792 0.1429312803679236 1.0630576745837845 -0.19296466237039328;-0.16304111168945135 0.62911370149017543 0.7362145464763884 0.073248539650610109 1.0136108294433117 1.1892462055678468 0.13358690125319911 0.70649334024216026 0.1291344287680104 -0.17121033089759474 -0.46012595802698009;-0.355054987397458 -0.60684010422052426 0.87482755754662844 0.11404555345471015 -0.45962904863240001 0.92124700298306139 -0.43923084212158592 -0.36214079692796902 -0.11850567396585722 0.9451736321215175 -0.32291054908964012;0.47548892712455298 0.34567488197801316 0.76109320351359144 0.93450710555200533 -0.55713666448979837 -0.48754562853125055 -1.1375347667430897 -0.19438188850257423 -0.23832055888803613 0.88395641848656525 0.57430617373123904;0.20376949110319625 -0.14299132290081243 1.1405372972898269 0.38743385490325666 0.67063733602317233 0.97323033254976099 0.29794385543743673 -0.52428207169154273 0.90337109443948838 0.21339875544192727 0.99214771520346301;1.2104463028007597 0.57370808573034826 0.003980258901624842 -0.1535401839042482 0.27771227223718553 1.1971843023115603 0.29833650166238812 -0.8371780329162628 0.09307533431017545 -0.62960163878762765 -1.3650540065833896;0.29990572319155434 0.44611801724712419 0.83126858102115564 0.66886244607884482 0.73477499795278367 -0.54304353890560997 -0.74442630849228975 -0.46838623267562479 1.010986423116097 -0.31753030579590535 -0.59628431240306468;0.98733918235562779 0.66522217976061804 -0.77508949420200579 -0.40050236127715466 -2.0963438705424786 0.86693166758923423 -2.3397473275224794 1.0599958711228119 0.21972499792190894 1.0261703027351081 1.1262613331286706;-0.98942162248113974 -0.6780477907808834 0.17062594826915561 0.25093067674908492 -0.10963326608288955 0.41302651934325724 -0.5610183904338284 1.7439043464224722 0.60266296013557141 -0.42093112715150438 1.2996830938260446;-1.481400968133487 2.0903941756003417 0.74879249022936178 -0.36669411355784992 0.39258256751298382 0.24150441020662153 0.24153213588155148 1.433023989752596 0.85727552645387184 0.67206232356902607 -0.19056273520187383;0.68663163155019236 0.51768912089155761 -0.43499864097405311 0.4256001656890217 0.3503144144131059 0.078769486758384452 0.47674230885393742 -0.15976023055908883 0.54247871242682977 -0.053122796107461116 0.2696526732461253;-0.2083599334314559 0.71768632579209846 0.55674240824035204 -0.63129072301442568 0.26413006542540557 -0.45655291832877526 -0.88321986566255661 -0.1599664110089084 -0.14174596053620148 0.56645797386551466 0.53667183607838853;-1.4260741777857182 1.1338554930872953 -0.021876542813439516 0.48248524774454843 -0.66746551224294992 -1.3756906045044279 -0.095063516084983826 2.4010093059519386 -0.60491027589487234 0.60760071307694441 0.10010458537513534;-1.0164593851972521 -0.093091826100881972 -0.7972992214805219 -0.047980814803271078 0.44642701654456696 0.97546085321779397 -0.28944060065415639 0.15487805267488106 -0.90954551240416937 -0.36843308594632351 0.12029212746210347];

% Layer 2
b2 = -0.26859211600793698;
LW2_1 = [0.45371525212557895 -0.18869998183229741 -0.15763004478368686 1.6251659425624609 0.99706588088233128 -2.152487093379885 -1.0536256208227233 -1.3747048999754061 -1.759299264118859 0.26082584881272342 -0.61516328637407913 -0.84814361079610168 0.49377773745021991 -1.3258739518041294 1.9707027341087882 1.7059794596878146 -1.4956637898674034 1.6417288882939394 0.12383524046879947 -0.092566786674225882 1.6093492818237563 0.95715362881711519];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
